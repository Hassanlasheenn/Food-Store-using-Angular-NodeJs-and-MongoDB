{"ast":null,"code":"import { Cart } from '../shared/models/Cart';\nimport { BehaviorSubject } from 'rxjs';\nimport { CartItem } from '../shared/models/cartItem';\nimport * as i0 from \"@angular/core\";\nexport class CartService {\n  constructor() {\n    this.cart = this.getCartFromLocalStorage();\n    this.cartSubject = new BehaviorSubject(this.cart);\n  }\n  addToCart(food) {\n    let cartItem = this.cart?.items?.find(item => item?.food?.id === food?.id);\n    if (cartItem) {\n      return;\n    } else {\n      this.cart?.items?.push(new CartItem(food));\n      this.setCartToLocalStorage();\n    }\n  }\n  removeFromCart(foodId) {\n    this.cart.items = this.cart.items.filter(item => item.food.id !== foodId);\n    this.setCartToLocalStorage();\n  }\n  changeQuantity(foodId, quantity) {\n    let cartItem = this.cart?.items?.find(item => item?.food?.id === foodId);\n    if (!cartItem) return;\n    cartItem.quantity = quantity;\n    cartItem.price = quantity * cartItem.food.price;\n    this.setCartToLocalStorage();\n  }\n  clearCart() {\n    this.cart = new Cart();\n    this.setCartToLocalStorage();\n  }\n  getCartObservable() {\n    return this.cartSubject.asObservable();\n  }\n  getCart() {\n    return this.cartSubject.value;\n  }\n  setCartToLocalStorage() {\n    this.cart.totalPrice = this.cart?.items?.reduce((prevSum, currentItem) => prevSum + currentItem?.price, 0);\n    this.cart.totalCount = this.cart?.items?.reduce((prevSum, currentItem) => prevSum + currentItem?.quantity, 0);\n    const cartJson = JSON.stringify(this.cart);\n    localStorage.setItem('cart', cartJson);\n    this.cartSubject.next(this.cart);\n  }\n  getCartFromLocalStorage() {\n    const cartJson = localStorage.getItem('cart');\n    return cartJson ? JSON.parse(cartJson) : new Cart();\n  }\n  static {\n    this.ɵfac = function CartService_Factory(t) {\n      return new (t || CartService)();\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: CartService,\n      factory: CartService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["Cart","BehaviorSubject","CartItem","CartService","constructor","cart","getCartFromLocalStorage","cartSubject","addToCart","food","cartItem","items","find","item","id","push","setCartToLocalStorage","removeFromCart","foodId","filter","changeQuantity","quantity","price","clearCart","getCartObservable","asObservable","getCart","value","totalPrice","reduce","prevSum","currentItem","totalCount","cartJson","JSON","stringify","localStorage","setItem","next","getItem","parse","factory","ɵfac","providedIn"],"sources":["/Users/hazemalaa/Desktop/Food-Store-using-Angular-NodeJs-and-MongoDB/frontend/src/app/services/cart.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Cart } from '../shared/models/Cart';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { Food } from '../shared/models/food';\nimport { CartItem } from '../shared/models/cartItem';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CartService {\n  private cart: Cart = this.getCartFromLocalStorage();\n  private cartSubject: BehaviorSubject<Cart> = new BehaviorSubject(this.cart);\n\n  constructor() {}\n\n  addToCart(food: Food): void {\n    let cartItem = this.cart?.items?.find(item => item?.food?.id === food?.id);\n    if(cartItem) {\n      return;\n    } else {\n      this.cart?.items?.push(new CartItem(food));\n      this.setCartToLocalStorage();\n    }\n  }\n\n  removeFromCart(foodId: string): void {\n    this.cart.items = this.cart.items.filter(item => item.food.id !== foodId);\n    this.setCartToLocalStorage();\n  }\n\n  changeQuantity(foodId: string, quantity: number) {\n    let cartItem = this.cart?.items?.find(item => item?.food?.id === foodId);\n    if(!cartItem) return;\n\n    cartItem.quantity = quantity;\n    cartItem.price = quantity * cartItem.food.price;\n    this.setCartToLocalStorage();\n  }\n\n  clearCart() {\n    this.cart = new Cart();\n    this.setCartToLocalStorage();\n  }\n\n  getCartObservable(): Observable<Cart> {\n    return this.cartSubject.asObservable();\n  }\n\n  getCart(): Cart {\n    return this.cartSubject.value;\n  }\n\n  private setCartToLocalStorage(): void {\n    this.cart.totalPrice = this.cart?.items?.reduce((prevSum, currentItem) => prevSum + currentItem?.price, 0);\n    this.cart.totalCount = this.cart?.items?.reduce((prevSum, currentItem) => prevSum + currentItem?.quantity, 0);\n    \n    const cartJson = JSON.stringify(this.cart);\n    localStorage.setItem('cart', cartJson);\n    this.cartSubject.next(this.cart);\n  }\n\n  private getCartFromLocalStorage(): Cart {\n    const cartJson = localStorage.getItem('cart');\n    return cartJson ? JSON.parse(cartJson) : new Cart();\n  }\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}